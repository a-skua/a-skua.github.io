---
layout: layouts/blog.njk
title: ImageMagickを使った画像変換
tags:
  - blog
categories:
  - web
  - linux
---

**パフォーマンス向上のためのデザイン設計**
というハチドリが表紙絵の本を読みました。

その中に
__画像の最適化__
という内容が書かれていたので、
早速実践。

画像変換で検索したところ、
どうも
**ImageMagick** 
というソフトをみんな使っているみたいなので、それを使うことにしました。

現在投稿している画像が **png** のものだけなので、
それ用に。

```shell
mogrify -verbose -strip -resize 800x800\> -quality 90 -define png:color-type=2 *.png
```

## -verbose

処理の内容を出力。

## -strip

メタデータのの削除。

## -resize

画像サイズの変更。

横x縦で指定し、
横幅だけの場合は
`800`

縦幅だけの場合は
`x800`

両方を指定するには
`800x800`

ここでは末尾に
`\>`
を付けています。

これはこのサイズを上回った場合にリサイズすると言う意味です。

なので、指定したサイズを上回らなかった場合は、リサイズされません。

## -quality

画像の品質の指定。
`jpg` だと、％なのですが、 `png` は違うようです…

## -define

固有設定っぽいです…

ここでは `png` の品質に関わる項目を設定しています。

## まとめ

正直なところ `png` の画像サイズを小さくしたからと言って
そこまで大きな圧縮効果は見込めませんでした。

画像を縮小した結果、中間色が増え逆に容量が増えるパターンもありますし、
`jpg` を用いたほうが圧縮率良いケースの方が多いのかな？と。

容量が上回った場合 `jpg` 、それ意外は `png` といったふうに指標を設けるべきだなと思いました。
